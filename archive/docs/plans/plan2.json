{
  "project": "Canonical Templates Repo",
  "branchName": "ralph/canonical-templates-repo",
  "description": "Canonical templates repo for LLM-assisted product engineering with verify-first workflow and vendor syncing.",
  "referenceDoc": "archive/docs/plans/plan2.md",
  "owner": "Marc",
  "status": "Draft (ready for implementation)",
  "primaryRunner": "Codex",
  "packageManagerRule": "pnpm",
  "canonicalManager": "dotagents",
  "focusStories": [
    "US-001",
    "US-002",
    "US-003"
  ],
  "changeLog": [
    {
      "timestamp": "2026-01-23T16:03:21Z",
      "summary": "Align plan2.json with plan2.md, expand vendor mappings, and mark top 3 stories.",
      "changes": [
        "Added metadata fields and reference doc.",
        "Marked focus stories (US-001, US-002, US-003).",
        "Expanded guardrails acceptance criteria.",
        "Detailed vendor mapping requirements."
      ]
    },
    {
      "timestamp": "2026-01-23T16:09:57Z",
      "summary": "Implement top-3 stories: guardrails + core templates + learnings templates.",
      "changes": [
        "Updated root AGENTS.md with platform note and source-of-truth guidance.",
        "Added .agents/AGENTS.md mirror.",
        "Created docs/templates core and learnings templates."
      ]
    },
    {
      "timestamp": "2026-01-23T16:24:51Z",
      "summary": "Add root typecheck script and validate top-3 stories.",
      "changes": [
        "Added package.json with typecheck script.",
        "Added scripts/typecheck.sh to verify required files.",
        "pnpm typecheck passed."
      ]
    },
    {
      "timestamp": "2026-01-23T16:28:46Z",
      "summary": "Add pnpm verify scaffolding and JSON PRD schema.",
      "changes": [
        "Added lint/test/build/verify scripts and package.json entries.",
        "Created docs/templates/json-prd.schema.json.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T16:29:17Z",
      "summary": "Expand typecheck coverage for JSON PRD schema.",
      "changes": [
        "Added docs/templates/json-prd.schema.json to scripts/typecheck.sh.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T16:39:52Z",
      "summary": "Complete US-005 through US-014 and run verification.",
      "changes": [
        "Added Oracle and Ralph guides.",
        "Scaffolded .agents structure and Ralph defaults.",
        "Defined vendor mappings and vendor update/sync/refresh scripts.",
        "Implemented cheatsheet generator and repo verification script.",
        "Added wf-explore and wf-shape runbooks.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T17:17:16Z",
      "summary": "Complete US-015 through US-024 and run verification.",
      "changes": [
        "Added wf-develop, wf-review, wf-release, wf-ralph, verify, compound, and oracle runbooks.",
        "Added Oracle wrapper script and Oracle skill.",
        "Created Explore, Shape, Develop, and Review skills.",
        "Refreshed cheatsheet and typecheck coverage.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T17:37:10Z",
      "summary": "Complete US-025 through US-030 and run verification.",
      "changes": [
        "Added Release and Compound skills, plus utility skills (create-cli, docs-list, trash).",
        "Added git hook templates and install script.",
        "Added Codex skills copy fallback script.",
        "Refreshed cheatsheet and typecheck coverage.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T17:38:18Z",
      "summary": "Document Codex skills copy usage and re-verify.",
      "changes": [
        "Added usage notes to scripts/install_codex_skills_copy.sh.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T17:45:26Z",
      "summary": "Add ask-questions-if-underspecified skill and re-verify.",
      "changes": [
        "Added utilities/ask-questions-if-underspecified skill (verbatim content).",
        "Refreshed cheatsheet and typecheck coverage.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T17:47:19Z",
      "summary": "Run vendor sync and repo verification.",
      "changes": [
        "Linked vendor commands and skills into .agents via vendor_sync.",
        "scripts/verify_repo.sh passed."
      ]
    },
    {
      "timestamp": "2026-01-23T18:17:00Z",
      "summary": "Refresh cheatsheet and verify after vendor sync.",
      "changes": [
        "cheatsheet.md updated.",
        "pnpm verify passed."
      ]
    },
    {
      "timestamp": "2026-01-23T18:52:59Z",
      "summary": "Run agents_refresh end-to-end.",
      "changes": [
        "vendor_update pulled latest inspiration repos.",
        "vendor_sync linked enabled items into .agents.",
        "cheatsheet regenerated and verify_repo passed."
      ]
    },
    {
      "timestamp": "2026-01-23T19:16:15Z",
      "summary": "Add canonical /handoff prompt mirror.",
      "changes": [
        "Replaced vendor symlink with local .agents/commands/handoff.md content."
      ]
    },
    {
      "timestamp": "2026-01-23T19:21:51Z",
      "summary": "Restore /handoff to vendor sync.",
      "changes": [
        "Removed local handoff file and re-linked vendor handoff via vendor_sync."
      ]
    }
  ],
  "userStories": [
    {
      "id": "US-001",
      "title": "Add canonical guardrails",
      "description": "As a maintainer, I want AGENTS.md guardrails in the repo root and .agents so that all clients follow the same rules.",
      "acceptanceCriteria": [
        "Root AGENTS.md includes taxonomy, command naming (wf-* + short utilities, no c-), pnpm rule, no roles/modes, no subagents, skill constraints, verify-first, and compounding rules",
        "Root AGENTS.md documents dotagents as canonical, .agents as source of truth, and macOS/Linux/WSL requirement",
        ".agents/AGENTS.md exists and mirrors the canonical guardrails",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Top-3 focus. Implemented; pnpm typecheck passed."
    },
    {
      "id": "US-002",
      "title": "Add core docs templates",
      "description": "As a product engineer, I want base templates for PRDs and plans so that outputs are consistent across projects.",
      "acceptanceCriteria": [
        "docs/templates/prd.md exists with required PRD sections",
        "docs/templates/breadboard.md, spike-plan.md, pack.md, and release-checklist.md exist",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Top-3 focus. Implemented; pnpm typecheck passed."
    },
    {
      "id": "US-003",
      "title": "Add learnings templates",
      "description": "As a team, I want learnings templates so that compounding is structured and append-only.",
      "acceptanceCriteria": [
        "docs/templates/learnings.md includes stage headings and append-only guidance",
        "docs/templates/learning-entry.md includes date, stage, summary, root cause, fix, prevention, verification, and links",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Top-3 focus. Implemented; pnpm typecheck passed."
    },
    {
      "id": "US-004",
      "title": "Add JSON PRD schema",
      "description": "As a tooling user, I want a JSON PRD schema so that PRD outputs are validated consistently.",
      "acceptanceCriteria": [
        "docs/templates/json-prd.schema.json exists",
        "Schema requires project, branchName, description, and userStories fields",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-005",
      "title": "Add Oracle and Ralph guides",
      "description": "As a user, I want guides for Oracle and Ralph so that I can run the tools correctly.",
      "acceptanceCriteria": [
        "docs/guides/oracle.md documents Node 22 requirement and wrapper usage",
        "docs/guides/ralph.md documents .ralph/, .agents/tasks/prd-<slug>.json, and iteration loop",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-006",
      "title": "Scaffold .agents structure",
      "description": "As a maintainer, I want the .agents directory structure in place so that skills and commands are organized by taxonomy.",
      "acceptanceCriteria": [
        ".agents/commands exists",
        ".agents/skills/{explore,shape,develop,review,release,compound,utilities} exist",
        ".agents/hooks/README.md exists with note that hooks are examples only",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-007",
      "title": "Add Ralph config defaults",
      "description": "As a maintainer, I want a Ralph config template so that continuous coding runs with consistent defaults.",
      "acceptanceCriteria": [
        ".agents/ralph/config.sh exists with AGENT_CMD default and override notes",
        ".agents/ralph/prompts/ exists (empty ok)",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-008",
      "title": "Define vendor sync mappings",
      "description": "As a maintainer, I want explicit vendor mappings so that synced commands and skills are deterministic.",
      "acceptanceCriteria": [
        ".agents/vendors.json exists",
        "Mappings cover full command + skill inventory from agent-scripts and compound-engineering-plugin",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "Implemented; pnpm verify passed. Required sync items: agent-scripts commands (handoff, pickup, landpr); agent-scripts skills (frontend-design, markdown-converter, nano-banana-pro, openai-image-gen, video-transcript-downloader); compound-engineering-plugin commands (triage, plan-review, deepen-plan, report-bug, reproduce-bug, resolve-parallel, resolve-pr-parallel, resolve-todo-parallel, agent-native-audit, changelog, generate-command, create-agent-skill, heal-skill, test-browser); compound-engineering-plugin skills (agent-browser, create-agent-skills, every-style-editor, file-todos, gemini-imagegen, skill-creator). Exclude vendor oracle."
    },
    {
      "id": "US-009",
      "title": "Implement vendor_update.sh",
      "description": "As a maintainer, I want a vendor update script so that inspiration repos are cloned and kept current.",
      "acceptanceCriteria": [
        "scripts/vendor_update.sh clones missing vendors into inspiration/ and pulls latest",
        "Script documents the vendor repo list it manages",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-010",
      "title": "Implement vendor_sync.sh",
      "description": "As a maintainer, I want a vendor sync script so that enabled items are surfaced into .agents.",
      "acceptanceCriteria": [
        "scripts/vendor_sync.sh reads .agents/vendors.json and creates symlinks under .agents",
        "Script refuses to overwrite non-symlinked local forks and prints guidance",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-011",
      "title": "Implement agents_refresh.sh",
      "description": "As a maintainer, I want a refresh script so that vendors, cheatsheet, and verification run in one step.",
      "acceptanceCriteria": [
        "scripts/agents_refresh.sh runs vendor_update, vendor_sync, generate_cheatsheet, and verify_repo in order",
        "Script prints a summary and exits non-zero on failure",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-012",
      "title": "Implement cheatsheet generator",
      "description": "As a maintainer, I want an automated cheatsheet so that skills and commands are discoverable.",
      "acceptanceCriteria": [
        "scripts/generate_cheatsheet.ts scans .agents/commands and .agents/skills",
        "cheatsheet.md includes commands, skills by category, hooks, pnpm ladder, and key output paths",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 12,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-013",
      "title": "Implement repo verification script",
      "description": "As a maintainer, I want a verify script so that taxonomy and formatting rules are enforced.",
      "acceptanceCriteria": [
        "scripts/verify_repo.sh validates taxonomy, frontmatter rules, required commands, unique skill names, and learnings templates",
        "Script prints manual smoke steps including vendor refresh",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-014",
      "title": "Add wf-explore and wf-shape runbooks",
      "description": "As a product engineer, I want Explore and Shape workflows so that strategy and PRDs are produced consistently.",
      "acceptanceCriteria": [
        ".agents/commands/wf-explore.md exists with purpose, inputs, outputs, steps, verification, and go/no-go",
        ".agents/commands/wf-shape.md exists with purpose, inputs, outputs, steps, verification, and go/no-go",
        "Typecheck passes"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-015",
      "title": "Add wf-develop and wf-review runbooks",
      "description": "As a product engineer, I want Develop and Review workflows so that changes are verified and reviewed consistently.",
      "acceptanceCriteria": [
        ".agents/commands/wf-develop.md exists with pnpm ladder and dev-log output",
        ".agents/commands/wf-review.md exists with pnpm verify and optional browser QA",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-016",
      "title": "Add wf-release and wf-ralph runbooks",
      "description": "As a product engineer, I want Release and Ralph workflows so that shipping and continuous coding are consistent.",
      "acceptanceCriteria": [
        ".agents/commands/wf-release.md includes pnpm verify and compound default for non-trivial work",
        ".agents/commands/wf-ralph.md asks for iteration count (default 10) and loops ralph build 1",
        "Typecheck passes"
      ],
      "priority": 16,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-017",
      "title": "Add verify and compound runbooks",
      "description": "As a maintainer, I want verify and compound utilities so that verification and learnings are standardized.",
      "acceptanceCriteria": [
        ".agents/commands/verify.md defines pnpm ladder and docs/verify.md fallback with NO-GO guidance",
        ".agents/commands/compound.md appends to docs/learnings.md with required fields",
        "Typecheck passes"
      ],
      "priority": 17,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-018",
      "title": "Add Oracle wrapper and skill",
      "description": "As a user, I want an Oracle wrapper so that the CLI always runs the latest version.",
      "acceptanceCriteria": [
        "scripts/oracle.sh runs pnpm dlx @steipete/oracle@latest and warns on Node < 22",
        ".agents/skills/utilities/oracle/SKILL.md exists and references the wrapper",
        ".agents/commands/oracle.md exists as an optional runbook",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 18,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-019",
      "title": "Create Explore skills",
      "description": "As a product strategist, I want Explore skills so that opportunity selection is consistent.",
      "acceptanceCriteria": [
        ".agents/skills/explore/opportunity-solution-tree/SKILL.md exists",
        "Placeholder skills exist for customer-segmentation, positioning, roadmap, and pricing-packaging",
        "All SKILL.md files use name+description frontmatter and include Inputs, Outputs, Verification headings",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-020",
      "title": "Create Shape skills set 1",
      "description": "As a product engineer, I want core Shape skills so that PRDs and breadboards are produced consistently.",
      "acceptanceCriteria": [
        "Skills exist for create-prd, breadboard, and spike-plan",
        "Each SKILL.md includes Inputs, Outputs, Verification headings",
        "Typecheck passes"
      ],
      "priority": 20,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-021",
      "title": "Create Shape skills set 2",
      "description": "As a product engineer, I want advanced Shape skills so that plans and JSON PRDs are standardized.",
      "acceptanceCriteria": [
        "Skills exist for deepen-plan, prd-review, and create-json-prd",
        "create-json-prd requires a PRD and notes optional breadboard/spike/plan inputs",
        "Typecheck passes"
      ],
      "priority": 21,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-022",
      "title": "Create Develop skills set 1",
      "description": "As an engineer, I want core Develop skills so that implementation and bug work are repeatable.",
      "acceptanceCriteria": [
        "Skills exist for work-execute, reproduce-bug, and report-bug",
        "Each SKILL.md includes Inputs, Outputs, Verification headings",
        "Typecheck passes"
      ],
      "priority": 22,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-023",
      "title": "Create Develop skills set 2",
      "description": "As an engineer, I want PR and todo resolution skills so that cleanup work is standardized.",
      "acceptanceCriteria": [
        "Skills exist for resolve-todos and resolve-pr-feedback",
        "Each SKILL.md includes Inputs, Outputs, Verification headings",
        "Typecheck passes"
      ],
      "priority": 23,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-024",
      "title": "Create Review skills",
      "description": "As a reviewer, I want Review skills so that audits and QA are consistent.",
      "acceptanceCriteria": [
        "Skills exist for pr-review, agent-native-architecture, and browser-qa",
        "browser-qa references utilities/agent-browser",
        "Typecheck passes"
      ],
      "priority": 24,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-025",
      "title": "Create Release skills",
      "description": "As a release owner, I want Release skills so that shipping is repeatable.",
      "acceptanceCriteria": [
        "Skills exist for release-checklist, changelog-draft, and post-release-verify",
        "Each SKILL.md includes Inputs, Outputs, Verification headings",
        "Typecheck passes"
      ],
      "priority": 25,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-026",
      "title": "Create Compound skill",
      "description": "As a team, I want a Compound skill so that learnings are captured in docs/learnings.md.",
      "acceptanceCriteria": [
        "Skill exists for compound-docs that appends to project docs/learnings.md",
        "Skill includes required entry fields and verification notes",
        "Typecheck passes"
      ],
      "priority": 26,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-027",
      "title": "Create local utility skills",
      "description": "As a maintainer, I want local utility skills so that common tasks are standardized.",
      "acceptanceCriteria": [
        "ask-questions-if-underspecified skill exists exactly as provided and marked explicit invoke only",
        "create-cli, docs-list, and trash skills exist with required headings",
        "Typecheck passes"
      ],
      "priority": 27,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-028",
      "title": "Add git hook templates",
      "description": "As a maintainer, I want hook templates so that quality checks can be enabled without installs.",
      "acceptanceCriteria": [
        "hooks/git/pre-commit and hooks/git/pre-push templates exist and degrade gracefully",
        "Optional templates exist for prepare-commit-msg, commit-msg, and post-merge",
        "Typecheck passes"
      ],
      "priority": 28,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-029",
      "title": "Add hook installer script",
      "description": "As a maintainer, I want an install script so that git hooks can be enabled consistently.",
      "acceptanceCriteria": [
        "scripts/install_git_hooks.sh installs templates into .git/hooks without running installs",
        "Script prints clear output and handles missing targets gracefully",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 29,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    },
    {
      "id": "US-030",
      "title": "Add Codex skills copy fallback",
      "description": "As a user, I want a copy fallback so that Codex works even if symlink loading regresses.",
      "acceptanceCriteria": [
        "scripts/install_codex_skills_copy.sh copies .agents/skills into Codex home",
        "Script includes usage instructions and safety checks",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 30,
      "passes": true,
      "notes": "Implemented; pnpm verify passed."
    }
  ]
}
